<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>1mobile</title>
	<link rel="stylesheet" media="all" href="data/css/all.css">
	<link rel="stylesheet" media="all" href="data/css/media.css">
	<script src="data/js/jquery-1.8.2.min.js"></script>
	<script src="data/js/hammer.js"></script>
	<script src="data/js/jquery.specialevent.hammer.js"></script>
	<script src="data/js/common.js"></script>
	<!--[if lt IE 9]>
		<script src="data/js/html5.js"></script>
		<script src="data/js/respond.min.js"></script>
	<![endif]-->
</head>
<body>

<div class="p-wrap">
	<div class="p-head">
		<nav class="b-nav">
			<a href="#" class="b-nav__pin">Races</a>
			<a href="#" class="b-nav__pin">Championship</a>
			<a href="#" class="b-nav__pin">Activity</a>
		</nav>
	</div>
	<div class="p-tape">
		<div class="p-races js-content">
			<!-- <div class="b-race b-clear">
				<a href="#" class="b-race__link">
					<img src="data/content/pic/flag/china.png" alt="Chinese Grand Prix" class="b-race__pic">
					<strong class="b-race__title">Chinese Grand Prix</strong>
				</a>
				<div class="b-race__dates">April 12-14</div>
				<div class="b-race__countdown">
					<span class="b-race__countdown__item"><span class="b-race__countdown__num">9</span>days</span>
					<span class="b-race__countdown__item"><span class="b-race__countdown__num">15</span>hrs</span>
					<span class="b-race__countdown__item"><span class="b-race__countdown__num">35</span>mins</span>
				</div>
			</div>
			<div class="b-race b-race_off b-clear">
				<a href="#" class="b-race__link">
					<img src="data/content/pic/flag/malaysia.png" alt="Chinese Grand Prix" class="b-race__pic">
					<strong class="b-race__title">Malaysian Grand Prix</strong>
				</a>
				<div class="b-race__dates">March 3-5</div>
			</div>
			<div class="b-race b-race_off b-clear">
				<a href="#" class="b-race__link">
					<img src="data/content/pic/flag/australia.png" alt="Chinese Grand Prix" class="b-race__pic">
					<strong class="b-race__title">Australian Grand Prix</strong>
				</a>
				<div class="b-race__dates">February 22-24</div>
			</div> -->
		</div>
	</div>
	<div class="p-foot">
		&copy;&nbsp;2012
	</div>
</div>

<script>
$(function(){
	/*
	var path = 'data/content/',
		$contentBox = $('.js-content-box'),
		$raceList = $('.js-race-list'),
		$raceLink = $('.js-race-link', $raceList),
		$raceName = $raceLink.data('name');

	$raceLink.click(function(e){
		e.preventDefault();
		var $this = $(this),
			$raceName = $this.data('name'),
			requestedJSON = path + $raceName + '/common.json',
			$currentClass = $raceList.data('class-current');

		if ( !$this.hasClass($currentClass) ) {
			getRaceData(requestedJSON);
		}

		$raceLink.removeClass($currentClass);
		$this.addClass($currentClass);

		console.log(requestedJSON);
	});

	function getRaceData(requestedJSON) {
		$.getJSON(requestedJSON, function(data) {
			drawCommonData(data);
		});
	}
	function drawCommonData(data) {
		var tpl = '' +
			'<div class="b-race">'+
				'<h1 class="b-race__name">'+ data.raceName +'</h1>' +
				'<div class="b-race__location">'+ data.city +', '+ data.country +'</div>'+
				'<img src="'+ data.pics.gifs[0] +'">'+
			'</div>'


		$contentBox.html(tpl)
	}

	var actions = 'hold tap swipe doubletap transformstart transform transformend dragstart drag dragend release';

	function hammerLog( event ){
		event.preventDefault();
		console.log('Type: ' + event.type + ', Fingers: ' + event.touches.length + ', Direction: ' + event.direction);
	}

	//$raceList.on( actions,  hammerLog );
	$raceList.on('drag', function(e){
		var $this = $(this),
			delta = $this.data('delta') || 0;
			delta = delta + e.distanceX;

		$this.css({
			'left': delta + 'px'
		});
		console.log(delta);
	});
	$raceList.on('dragend', function(e){
		var $this = $(this),
			pos = parseFloat($this.css('left'));
		$this.data('delta', pos);
		console.log('pos: ' +pos);
	});*/

	function getRaces(id) {
		$.getJSON('data/content/json/races.json', function(json) {
			var races = json.races;
			$.each(races, function(i) {
				var race = races[i],
					raceId = race.race_id,
					raceName = race.race_name,
					raceDates = race.race_timetable.race,
					raceFlag = 'data/content/pic/flag/' + race.race_alias + '.png',
					blockMods,
					raceTemplate;

				if (raceId != id) {
					blockMods = ' b-race_off';
				}


				raceTemplate = [
				'<div class="b-race b-clear', blockMods, '">',
					'<a href="#', raceId, '" class="b-race__link">',
						'<img src="', raceFlag, '" alt="', raceName, '" class="b-race__pic">',
						'<strong class="b-race__title">', raceName, '</strong>',
					'</a>',
					'<div class="b-race__dates">', raceDates, '</div>',
					'<div class="b-race__countdown">',
						'<span class="b-race__countdown__item"><span class="b-race__countdown__num">9</span>days</span>',
						'<span class="b-race__countdown__item"><span class="b-race__countdown__num">15</span>hrs</span>',
						'<span class="b-race__countdown__item"><span class="b-race__countdown__num">35</span>mins</span>',
					'</div>',
				'</div>'].join('');

				$('.js-content').prepend(raceTemplate);
				console.log(raceTemplate);
			});
		});
	}

	getRaces('3');
});
</script>

</body>
</html>
